generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  SUPER_ADMIN
  GYM_ADMIN
  TRAINER
  STAFF
  STUDENT
}

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  role      UserRole
  password  String
  gymId     Int?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  gym       Gym?       @relation(fields: [gymId], references: [id])
  payments  Payment[]
  exercises Exercise[]
  student   Student?
  classes   Class[]

  @@map("users")
}

model Gym {
  id          Int      @id @default(autoincrement())
  name        String
  address     String
  phone       String
  schedule    String
  code        String   @unique
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  users       User[]
  memberships Membership[]
  classes     Class[]
  students    Student[]
  inventory   Inventory[]
  payments    Payment[]
  exercises   Exercise[]

  @@map("gyms")
}

model Membership {
  id          Int      @id @default(autoincrement())
  name        String
  duration    String
  price       String
  description String
  gymId       Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  gym      Gym       @relation(fields: [gymId], references: [id])
  payments Payment[]

  @@map("memberships")
}

model Class {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  schedule    DateTime
  trainerId   Int
  gymId       Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  trainer User @relation(fields: [trainerId], references: [id])
  gym     Gym  @relation(fields: [gymId], references: [id])

  @@map("classes")
}

model Student {
  id        Int      @id @default(autoincrement())
  name      String
  birthDate DateTime
  userId    Int      @unique
  gymId     Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id])
  gym  Gym  @relation(fields: [gymId], references: [id])

  @@map("students")
}

model Payment {
  id             Int      @id @default(autoincrement())
  amount         String
  date           DateTime
  paymentMethod  String
  userId         Int
  membershipId   Int
  gymId          Int
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  user       User       @relation(fields: [userId], references: [id])
  membership Membership @relation(fields: [membershipId], references: [id])
  gym        Gym        @relation(fields: [gymId], references: [id])

  @@map("payments")
}

model Inventory {
  id        Int      @id @default(autoincrement())
  name      String
  type      String
  quantity  Int
  gymId     Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  gym Gym @relation(fields: [gymId], references: [id])

  @@map("inventory")
}

model Exercise {
  id          Int      @id @default(autoincrement())
  name        String
  description String
  userId      Int
  gymId       Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  user User @relation(fields: [userId], references: [id])
  gym  Gym  @relation(fields: [gymId], references: [id])

  @@map("exercises")
}